[blog.miguelgrinberg.com](http://blog.miguelgrinberg.com "blog.miguelgrinberg.com")

# Мега-Учебник Flask, Часть 1: Hello, World! #
### *Miguel Grinberg* ###

----

Эта статья является переводом нового издания учебника Мигеля Гринберга. [Прежний перевод](https://habrahabr.ru/post/193242/ "Прежний перевод") давно утратил свою актуальность. Оригинальный учебник избавлен от некоторых неточностей, вызванных быстрым развитием веб, но лучше пользоваться новым.

Автор планирует завершить его выпуск в мае 2018. Я, со своей стороны, постараюсь не отставать с переводом.

[**VIDEO**](https://player.vimeo.com/video/248628320 "video")

Добро пожаловать! 

``Вы собираетесь отправиться в путешествие, чтобы узнать, как создавать веб-приложения с помощью [Python](https://python.org/ "Python") и микрофреймворка [Flask](http://flask.pocoo.org/ "Flask") . Видео выше даст вам обзор содержимого этого руководства. В этой первой главе вы узнаете, как настроить проект Flask. В конце этой главы у вас будет простое веб-приложение Flask, работающее на вашем компьютере!

Для справки ниже приведен список статей этой серии.

- **Глава 1: Привет, мир! (Эта статья)**
- **Глава 2: Шаблоны**
- **Глава 3: Веб-формы**
- **Глава 4: База данных**
- **Глава 5: Пользовательские логины**
- Глава 6: Страница профиля и аватары (доступно 9 января 2018 года)
- Глава 7: Обработка ошибок (доступно 16 января 2018 года)
- Глава 8: Подписчики, контакты и друзья (доступны 23 января 2018 года)
- Глава 9: Разбивка на страницы (доступна 30 января 2018 года)
- Глава 10: Поддержка электронной почты (доступна 6 февраля 2018 года)
- Глава 11: Реконструкция (доступна 13 февраля 2018 года)
- Глава 12: Дата и время (доступно 20 февраля 2018 года)
- Глава 13: I18n и L10n (доступно 27 февраля 2018 года)
- Глава 14: Ajax (доступно 6 марта 2018 года)
- Глава 15: Улучшение структуры приложения (доступно 13 марта 2018 года)
- Глава 16: Полнотекстовый поиск (доступен 20 марта 2018 года)
- Глава 17: Развертывание в Linux (доступно 27 марта 2018 года)
- Глава 18: Развертывание на Heroku (доступно 3 апреля 2018 года)
- Глава 19: Развертывание на Docker контейнерах (доступно 10 апреля 2018 года)
- Глава 20: Магия JavaScript (доступна 17 апреля 2018 года)
- Глава 21: Уведомления пользователей (доступно 24 апреля 2018 года)
- Глава 22: Справочные задания (доступны 1 мая 2018 года)
- Глава 23: Интерфейсы прикладного программирования (API) (доступно 8 мая 2018 г.)

*Примечание 1: Если вы ищете старые версии данного курса, это [здесь](https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world-legacy "здесь").*

*Примечание 2: Если вдруг Вы хотели бы выступить в поддержку моей(Мигеля) работы в этом блоге, или просто не имеете терпения дожидаться неделю статьи, я (Мигель Гринберг)предлагаю полную версию данного руководства упакованную электронную книгу или видео. Для получения более подробной информации посетите [learn.miguelgrinberg.com](http://learn.miguelgrinberg.com "learn.miguelgrinberg.com").*

Все примеры кода представленные в этом учебном курсе, размещенный на GitHub . Загрузка кода из GitHub поможет вам сэкономить время, но я настоятельно рекомендуем введите код самостоятельно, по крайней мере, первые несколько глав. После того, как вы станете больше знакомы с Flask можно получить доступ к коду прямо из GitHub, в том случае, если ввод становится слишком утомительным.

В начале каждой главы, Я дам вам три GitHub ссылки, которые могут быть полезны при изучении главы. **Browse** откроет GitHub репозиторий для микроблога в том месте, где собраны изменения к главе, которую Вы читаете, за исключением любых изменений, внесенных в будущих главах. **Zip** - это ссылка для загрузки zip-архива, в том числе приложения  и изменений в главе. **Diff** - откроет графическое представление всех изменений, внесенных в главу, которую Вы собираетесь читать.

*На GitHub ссылки в этой главе: [Browse](https://github.com/miguelgrinberg/microblog/tree/v0.1 "Browse ") , [Zip](https://github.com/miguelgrinberg/microblog/archive/v0.1.zip "Zip"), [Diff](https://github.com/miguelgrinberg/microblog/compare/v0.0...v0.1 "Diff").*

## Установка Python ##

Если на вашем компьютере не установлен **Python**, установите его. Если ваша операционная система не имеет предустановленный пакет Python, вы можете скачать программу установки с [официального сайта Python](http://python.org/download/). Если вы используете Microsoft Windows вместе с WSL или Cygwin, обратите внимание, что вы не будете использовать родную версию Python для Windows, а версию, совместимую с Unix, которую вам нужно получить от Ubuntu (если вы используете WSL) или от Cygwin.

Чтобы убедиться, что ваша установка Python является функциональной, вы можете открыть окно терминала и ввести python3, или если это не работает, просто python. Вот что вам следует ожидать:

    $ python3
    Python 3.5.2 (default, Nov 17 2016, 17:05:23)
    [GCC 5.4.0 20160609] on linux
    Type "help", "copyright", "credits" or "license" for more information.
    >>> _

или так в cmd  (окно командной строки Microsoft Windows) :

    c:\cp>c:\python33\python
    Python 3.3.5 (v3.3.5:62cf4e77f785, Mar  9 2014, 10:37:12) [MSC v.1600 32 bit (In
    tel)] on win32
    Type "help", "copyright", "credits" or "license" for more information.
    >>>

Интерпретатор Python теперь находится в ожидании пользовательского ввода. В будущих главах вы узнаете, для чего это интерактивное приглашение полезно. Но пока Вы подтвердили, что Python установлен в вашей системе. Чтобы выйти из интерактивного приглашения, вы можете ввести `exit()` и нажать Enter. 

В версиях Python для Linux и Mac OS X вы также можете выйти из интерпретатора, нажав `Ctrl-D`. 

В Windows, ярлык выхода - `Ctrl-Z`, затем Enter.

## Установка Flask ##

Следующий шаг - установить Flask, но прежде чем я расскажу об этом, я хочу рассказать вам о лучших методах, связанных с установкой пакетов Python.

В Python пакеты, такие как Flask, доступны в общем репозитории, откуда их можно загрузить и установить. Официальный репозиторий пакетов Python называется [PyPI](https://pypi.python.org/pypi), что означает Python Package Index (также известный, как «cheese shop»). Установка пакета из PyPI очень проста, потому что у Python есть инструмент под названием pip, который выполняет эту работу (в Python 2.7 `pip` не входит в комплект с Python и его нужно устанавливать отдельно).

Чтобы установить пакет на свой компьютер, вы используете pip следующим образом:

    $ pip install <package-name>

Интересно, что этот метод установки пакетов не будет работать в большинстве случаев. Если ваш интерпретатор Python был установлен глобально для всех пользователей вашего компьютера, велика вероятность того, что ваша обычная учетная запись пользователя не получит разрешения на внесение в нее изменений, поэтому единственный способ выполнить вышеприведенную команду - запустить ее от имени администратора. Но даже без этого осложнения поймите, что происходит, когда вы устанавливаете пакет, как указанным выше способом. Инструмент `pip` загрузит пакет из PyPI, а затем добавит его в вашу папку Python. С этого момента каждый скрипт Python, который у вас есть в вашей системе, будет иметь доступ к этому пакету. Представьте ситуацию, когда вы закончили веб-приложение с использованием версии 0.11 Flask, которая была самой последней версией Flask при запуске, но теперь она была заменена версией 0.12. Теперь вы хотите запустить второе приложение, для которого вы хотели бы использовать версию 0.12, но если вы замените установленную версию 0.11, вы рискуете сломать свое старое приложение. Вы видите проблему? Было бы идеально, если бы можно было установить Flask 0.11, который будет использоваться вашим старым приложением, а также установить Flask 0.12 для Вашего нового.

Чтобы решить проблему поддержки различных версий пакетов для разных приложений, Python использует концепцию виртуальных сред. Виртуальная среда - это полная копия интерпретатора Python. Когда вы устанавливаете пакеты в виртуальной среде, общесистемный интерпретатор Python не затрагивается, только копия. Таким образом, решение иметь полную свободу для установки любых версий ваших пакетов для каждого приложения - использовать другую виртуальную среду для каждого приложения. Виртуальные среды имеют дополнительное преимущество, они принадлежат пользователю, который их создает, поэтому им не требуется учетная запись администратора.

Начнем с создания каталога, в котором будет жить проект. Я собираюсь назвать этот каталог **microblog**, так как это имя приложения:

    $ mkdir microblog
    $ cd microblog

Если вы используете версию Python 3, в нее включена поддержка виртуальной среды, поэтому все, что вам нужно сделать для ее создания, это:

    $ python3 -m venv venv

С помощью этой команды Python запустит пакет `venv`, который создает виртуальную среду с именем `venv`. Первым `venv` в команде является имя пакета виртуальной среды Python, а второе - имя виртуальной среды, которое я буду использовать для этой конкретной среды. Если вы считаете, что это сбивает с толку, вы можете заменить второй `venv` другим именем, которое вы хотите назначить своей виртуальной среде. В общем, я создаю свои виртуальные среды с именем `venv` в каталоге проекта, поэтому всякий раз, когда я подключаюсь к проекту, я нахожу его соответствующую виртуальную среду.

Обратите внимание, что в некоторых операционных системах вам может понадобиться использовать `python` вместо `python3` в приведенной выше команде. Некоторые установки используют `python` для релизов Python 2.x и python3 для релизов 3.x, в то время как другие отображают `python` в выпусках 3.x.

По завершении команды вы будете иметь каталог с именем `venv`, где хранятся файлы виртуальной среды.

Если вы используете любую версию Python старше 3.4 (включая выпуск 2.7), виртуальные среды не поддерживаются изначально. Для этих версий Python вам необходимо загрузить и установить сторонний инструмент [virtualenv](https://virtualenv.pypa.io/), прежде чем создавать виртуальные среды. После того, как `virtualenv` установлен, вы можете создать виртуальную среду со следующей командой:

    $ virtualenv venv

или так

    $ python virtualenv.py venv

***Прим.переводчика:** У меня установлено несколько версий Python. Я использую Python3.3. В моем случае пришлось вводить строку так:*

    C:\microblog>c:\Python33\python.exe c:\Python33\Lib\site-packages\virtualenv.py venv

*В полученном сообщении видно, что установлен `pip` и ряд пакетов:*

    Using base prefix 'c:\\Python33'
    New python executable in C:\microblog\venv\Scripts\python.exe
    Installing setuptools, pip, wheel...done.

Независимо от метода, который вы использовали для его создания, вы создали свою виртуальную среду. Теперь вам нужно сообщить системе, что вы хотите ее использовать, активируя ее. Чтобы активировать новую виртуальную среду, используете следующую команду:

    $ source venv/bin/activate
    (venv) $ _

Если вы используете cmd (окно командной строки Microsoft Windows), команда активации немного отличается:

    $ venv\Scripts\activate
    (venv) $ _

Когда вы активируете виртуальную среду, конфигурация сеанса терминала изменяется так, что интерпретатор Python, хранящийся внутри нее, станет тем, который вызывается при вводе `python`. Кроме того, в запросе терминала включено имя активированной виртуальной среды. Изменения, внесенные в сеанс терминала, являются временными и частными для этого сеанса, поэтому они не будут сохраняться при закрытии окна терминала. Если вы одновременно работаете с несколькими терминальными окнами, отлично видно, чтобы на каждом из них были задействованы разные виртуальные среды.

Теперь, когда вы создали и активировали виртуальную среду, вы можете, наконец, установить в нее Flask:


    (venv) C:\microblog>pip install flask
    Collecting flask
      Using cached Flask-0.12.2-py2.py3-none-any.whl
    Requirement already satisfied: click>=2.0 in c:\python33\lib\site-packages (from flask)
    Requirement already satisfied: Werkzeug>=0.7 in c:\python33\lib\site-packages (from flask)
    Requirement already satisfied: Jinja2>=2.4 in c:\python33\lib\site-packages (from flask)
    Requirement already satisfied: itsdangerous>=0.21 in c:\python33\lib\site-packages (from flask)
    Requirement already satisfied: markupsafe in c:\python33\lib\site-packages (from Jinja2>=2.4->flask)
    Installing collected packages: flask
    Successfully installed flask-0.12.2
    
    (venv) C:\microblog>

Если вы хотите подтвердить, что в вашей виртуальной среде установлен Flask, вы можете запустить интерпретатор Python и импортировать Flask в него:

    (venv) C:\microblog>python
    Python 3.3.5 (v3.3.5:62cf4e77f785, Mar  9 2014, 10:37:12) [MSC v.1600 32 bit (Intel)] on win32
    Type "help", "copyright", "credits" or "license" for more information.
    >>> import flask
    >>>

Если этот импорт не дает вам никаких ошибок, вы можете поздравить себя, так как `Flask` установлен и готов к использованию.


## Flask приложение «Привет, мир» ##

If you go to the Flask website, you are welcomed with a very simple example application that has just five lines of code. Instead of repeating that trivial example, I'm going to show you a slightly more elaborate one that will give you a good base structure for writing larger applications.

Если вы зайдете на [сайт Flask](http://flask.pocoo.org/), вас приветствует очень простое примерное приложение с пятью строками кода. Вместо того, чтобы повторять этот тривиальный пример, я покажу вам немного более сложный, который даст вам хорошую базовую структуру для написания больших приложений.

Приложение будет существовать в виде пакета. 

***Прим.переводчика:** Пакет - это коллекция модулей.* 

В Python подкаталог, содержащий файл `__init__.py`, считается пакетом и может быть импортирован. Когда вы импортируете пакет, `__init__.py` выполняет и определяет, какие символы предоставляют пакет для внешнего мира.

Давайте создадим пакет под названием `app`, в котором будет размещено приложение. Убедитесь, что вы находитесь в каталоге `microblog`, а затем выполните следующую команду:

    (venv) $ mkdir app

`__init__.py` для пакета приложения будет содержать следующий код:

    from flask import Flask
    
    app = Flask(__name__)
    
    from app import routes

Сценарий выше просто создает объект приложения как экземпляр класса Flask, импортированного из пакета flask. Переменная `__name__`, переданная в класс Flask, является предопределенной переменной Python, которая задается именем модуля, в котором она используется. Flask использует расположение модуля, переданного здесь как отправную точку, когда ему необходимо загрузить связанные ресурсы, такие как файлы шаблонов, которые я расскажу в главе 2. Для всех практических целей передача `__name__` почти всегда будет настраивать flask в правильном направлении. Затем приложение импортирует модуль `routes`, который еще не существует.